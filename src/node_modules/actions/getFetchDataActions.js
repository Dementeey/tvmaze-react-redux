import setDataActions from "actions/setDataActions";
import setDataParsedActions from "actions/setDataParsedActions";
import {parseResponseInNewArray} from "../myHelpers";
import setTrueStatusSuccessActions from "actions/setTrueStatusSuccessActions";
import setTrueStatusPendingActions from "actions/setTrueStatusPendingActions";
// import userRequestActions from "actions/userRequestActions";
import store from "store";
import setTrueStatusRejectActions from "actions/setTrueStatusRejectActions";


export default (str) => {
  return dispatch => {
    fetch(`http://api.tvmaze.com/search/shows?q=${str}`)
      .then(r => r.json())
      .then(r => {

        dispatch(setDataActions(r));
        dispatch(setDataParsedActions(parseResponseInNewArray(r)));
        dispatch(setTrueStatusSuccessActions());
        dispatch(setTrueStatusSuccessActions());
        if (Object.keys(r).length === 0) {
          store.dispatch(setTrueStatusRejectActions())
        }
      })
      .catch(() => dispatch(setTrueStatusPendingActions()));
  }
};
